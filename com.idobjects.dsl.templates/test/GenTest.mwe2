module GenTest

import org.eclipse.emf.mwe.utils.*
import com.idobjects.dsl.IdObjectsDslStandaloneSetupGenerated

var targetDir="test-src-gen"
var fileEncoding = "UTF-8"
var modelPath ="test"

Workflow {

	bean = org.eclipse.emf.mwe.utils.StandaloneSetup {
	 	platformUri=".."
	}

	component = org.eclipse.xtext.mwe.Reader {
		// lookup all resources on the classpath
		//useJavaClassPath = false

		// or define search scope explicitly
		path = modelPath
		skipOnErrors = true
		
		// this class will be generated by the xtext generator
		register =IdObjectsDslStandaloneSetupGenerated {}

		
		load = {
			slot = "packages"
			type = "Package"
		}
	}

	component = org.eclipse.xpand2.Generator {
		metaModel = org.eclipse.xtend.typesystem.emf.EmfMetaModel {
			metaModelPackage = "com.idobjects.dsl.idObjectsDsl.IdObjectsDslPackage"
		}
		
		expand = "RootTemplate::main FOREACH packages"
		
		outlet = {
			path = targetDir
		}
		fileEncoding = fileEncoding
	}
}